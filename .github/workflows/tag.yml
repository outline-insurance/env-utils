on:
  push:
    branches:
      - production
      - graham/test-new-release
  
name: Tag new version of Env-Utils

jobs:
    tag:
        name: Tag New Version
        runs-on: [ubuntu-latest]
        timeout-minutes: 15

        steps:
        - name: Checkout
          # From: https://github.com/actions/checkout
          uses: actions/checkout@v2
        
        - name: Extract Tag
          id: version_extract
          run: |
            echo "::set-output name=version::$(cat version.txt)"

        - name: Bump Version and Push New Tag
          id: tag_version
          # From: https://github.com/marketplace/actions/github-tag
          uses: mathieudutour/github-tag-action@v6.0
          with:
            github_token: ${{ secrets.GITHUB_TOKEN }}
            # default to patch releases (we will only patch this repo as we eventually want to deprecate)
            default_bump: patch
            custom_tag:  ${{ steps.version_extract.outputs.version }}
            dry_run: true
